Vue.component("blogger-header",{template:"#v-blogger-header",props:["article","getImageSrc"]}),Vue.component("blogger-avatar-info",{template:"#v-blogger-avatar-info",props:["article"]}),Vue.component("blogger-profile",{template:"#v-blogger-profile",props:["article"]}),Vue.component("blogger-recruitment",{template:"#v-blogger-recruitment"}),Vue.component("progress-bar",{computed:{article:function(){return this.$store.getters.activeArticle},progress:function(){return"width: "+this.$store.getters.progress+"%"},shouldShow:function(){return{"nav-down-1":this.$store.getters.progressBarVisible}}},template:"#v-progress-bar"}),Vue.component("action-bar",{props:["whatsappMsg"],data:function(){return{activePanel:"primary",togglingBookmark:!1}},computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn},article:function(){return this.$store.getters.activeArticle},activeIndex:function(){return this.$store.getters.activeIndex},getSpinnerVisibility:function(){return{invisible:!this.$store.getters.isArticleLoading}},getClipboardUrl:function(){return this.article.url+"?utm_medium=share&utm_source=clipboard_share"},bindBookmarkData:function(){if(!this.isLoggedIn)return{"data-toggle":"popover","data-placement":"top","data-content":"請先登入"}},isBookmarkActive:function(){if(this.isLoggedIn)return{active:"1"===this.article.bookmark}},bindPrimaryPanelClass:function(){return this.bindPanelClass("primary")},bindSecondaryPanelClass:function(){return this.bindPanelClass("secondary")},desktopSkintestIcon:function(){return"assets/img/skintest/"+(App.isCookieExist("skinId")?"icn_recommend_5x_desktop.png":"icn_skintest_5x_desktop.png")},mobileSkintestIcon:function(){return"assets/img/skintest/"+(App.isCookieExist("skinId")?"icn_recommend_5x_mobile.png":"icn_skintest_5x_mobile.png")},skintestUrl:function(){return App.isCookieExist("skinId")?"https://bit.ly/2vJSrHA":"https://bit.ly/33J85zD"}},methods:{bindPanelClass:function(t){return t===this.activePanel?{}:{"d-none":!0,"d-sm-flex":!0}},onNextArticleButtonClicked:function(){this.$emit("on-next-article-button-clicked",!0),this.sendEvent("Next Article Button Clicked")},sendEvent:function(t){var e,i=!!this.article.blogger;if(!this.$store.getters.preview){var n=this.article.title;e=i?"["+this.article.section.name_eng+"] "+n:"["+this.article.section.name_eng+"] ["+this.article.subsection.name_eng+"] "+n,ga("send","event",{eventCategory:"Article Details Bottom Nav",eventAction:t,eventLabel:e})}},sendSkintestGAEvent:function(t){return ga("send","event",{eventCategory:"Skin Test Entry Point",eventAction:"Skin Test Entry Click",eventLabel:t}),!0},setPopover:function(t){t.on("shown.bs.popover",function(){setTimeout(function(){t.popover("hide")},2e3)})},shareArticle:function(t){var e,i=this.article.url;switch(t){case"facebook":e="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(i+"?utm_medium=share&utm_source=fb_share");break;case"whatsapp":var n=this.article.title+"\n"+i.substring(0,i.lastIndexOf("/"))+"?utm_medium=share&utm_source=whatsapp_share\n\n";e="whatsapp://send?text="+encodeURIComponent(n+this.whatsappMsg)}this.sendEvent(t+" Share Button Clicked"),window.open(e)},toggleBookmark:function(){if(this.isLoggedIn&&!this.togglingBookmark){this.togglingBookmark=!0;var t="1"===this.article.bookmark?"undo-bookmark":"bookmark",e="article/"+this.article.id+"/bookmark"+("undo-bookmark"===t?"/undo":"");$.ajax({method:"GET",url:e,dataType:"json"}).done(function(){this.$store.dispatch("TOGGLE_BOOKMARK",this.activeIndex),"bookmark"===t&&this.sendEvent("Bookmark Button Clicked"),this.togglingBookmark=!1}.bind(this)).fail(function(){console.log("fail to save")})}},switchPanel:function(){this.activePanel="primary"===this.activePanel?"secondary":"primary"}},mounted:function(){new ClipboardJS(".control-panel__icon-btn .link").on("success",this.sendEvent.bind(null,"Clipboard Button Clicked")),$('[data-toggle="popover"]').popover(),this.setPopover($(this.$refs.btnCopyLink)),this.setPopover($(this.$refs.btnBookmark))},template:"#v-action-bar"}),Vue.component("fab",{data:function(){return{anim:{show:"bounceInUp",hide:"fadeOutDown"}}},computed:{section:function(){return this.$store.getters.activeArticle.section},visible:function(){return this.$store.getters.fabVisible},href:function(){return this.section.uri+"?utm_source=ub&utm_medium=detailpage"}},watch:{visible:function(){var t=$(this.$refs.button);this.visible?(t.removeClass(this.anim.hide),t.addClass("show "+this.anim.show)):(t.removeClass(this.anim.show),t.addClass(this.anim.hide))}},template:"#v-fab"}),Vue.component("dfp",{props:["id","bannerIndex","zone","type"],data:function(){return{holder:this.id&&this.bannerIndex?this.id+"-"+this.bannerIndex:"0"}},computed:{getZone:function(){return this.zone+"-"+this.bannerIndex+"-"+this.id}},template:"#v-dfp"}),Vue.component("affiliation-text-link",{props:["article","slotName","sizes"],computed:{id:function(){return"affiliation-"+this.slotName+"-"+this.article.id}},mounted:function(){googletag.cmd.push(function(){var t=[this.article.section.name_chi];this.article.subsection&&t.push(this.article.subsection.name_chi);var e=googletag.defineSlot("/21807278789/"+this.slotName,this.sizes,this.id).addService(googletag.pubads()).setTargeting("article_id",this.article.id).setTargeting("section",t);if(this.article.formal_tags){var i=[];this.article.formal_tags.forEach(function(t){i=i.concat(t.name.split(/[,-]/))}),e.setTargeting("formal_tag",i)}this.article.content_targeting&&e.setTargeting("keyword",this.article.content_targeting.split(/,/)),googletag.display(this.id)}.bind(this))},template:"#v-affiliation-text-link"}),Vue.component("flying-carpet",{props:["article"],data:function(){return{active:!1,id:"flying-carpet",runnable:null}},methods:{setIsActive:function(){clearTimeout(this.runnable),this.runnable=setTimeout(function(){this.active="mobile"===App.UBBannerSwap.getCurrentBreakPoint().name}.bind(this),250)},init:function(){googletag.cmd.push(function(){var t=[this.article.section.name_chi];this.article.subsection&&t.push(this.article.subsection.name_chi);var e=[[1,1],[300,250],[300,100]],i=googletag.defineSlot("/183518426/UBeauty2_WebRP_BeautyDetail_MobileInArticle",e,this.id).defineSizeMapping(googletag.sizeMapping().addSize([0,0],e).build()).addService(googletag.pubads()).setTargeting("article_id",this.article.id).setTargeting("section",t);if(this.article.formal_tags){var n=[];this.article.formal_tags.forEach(function(t){n=n.concat(t.name.split(/[,-]/))}),i.setTargeting("formal_tag",n)}this.article.content_targeting&&i.setTargeting("keyword",this.article.content_targeting.split(/,/)),googletag.display(this.id)}.bind(this))}},beforeMount:function(){window.addEventListener("resize",this.setIsActive)},beforeDestroy:function(){window.removeEventListener("resize",this.setIsActive)},mounted:function(){this.setIsActive()},updated:function(){this.active},template:"#v-flying-carpet"}),Vue.component("promo-box",{props:["type","eventLabel"],data:function(){return"desktop"===this.type?{containerClass:"mobile-d-b",contentWrapperClass:"col-md-12 col-lg-12",btnWrapperClass:"col-md-12 col-lg-12",logoStyle:""}:{containerClass:"mobile-d-n",contentWrapperClass:"col-md-10 col-lg-10",btnWrapperClass:"col-md-2 col-lg-2",logoStyle:"margin: auto; width: 50%; background: none"}},computed:{},methods:{},template:"#v-promo-box"}),Vue.component("infinity-scroll",{props:["threshold"],data:function(){return{itemsLoaded:0}},computed:{pendingList:function(){return this.$store.getters.pendingArticles},isLoading:function(){return this.$store.getters.isArticleLoading},eventLabel:function(){return this.$store.getters.activeArticle.url},preview:function(){return this.$store.getters.preview}},methods:{handleScroll:function(){this.isLoading||this.preview||!this.$refs.loadNext||this.$refs.loadNext.getBoundingClientRect().top<=window.innerHeight&&this.$emit("on-next-article")},onButtonClicked:function(){this.$emit("on-next-article"),this.$store.getters.preview||ga("send","event",{eventCategory:"Article Details Content",eventAction:"Load More Button Clicked",eventLabel:this.eventLabel})}},watch:{pendingList:function(){++this.itemsLoaded>=this.threshold&&window.removeEventListener("scroll",this.handleScroll)}},beforeMount:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll)},template:"#v-infinity-scroll"});var articleWrapperMixin={methods:{setProgressVisibility:function(t){this.shouldShowProgress=t,this.$store.dispatch("SET_PROGRESSBAR_VISIBLE",{index:this.index,visible:this.shouldShowProgress})},setFabVisibility:function(t){this.shouldShowFab!==t&&(this.shouldShowFab=t,this.$store.dispatch("SET_FAB_VISIBLE",{index:this.index,visible:this.shouldShowFab}))},handleContentScrollState:function(){var t=(this.$refs.content.$el||this.$refs.content).getBoundingClientRect(),e=(-t.top+this.yOffset.top)/t.height*100;this.handleSideBarState(t,e),e=Math.max(0,Math.min(e,100)),this.$store.dispatch("SET_PROGRESS",{index:this.index,progress:e}),this.handleProgressBarState(t,e),this.scrollProgress=e,this.$store.commit("SET_OPEN_APP_VISIBLE",0===this.scrollProgress)},handleSideBarState:function(t,e){if(e>=0&&e<=100){var i=(this.$refs.side.$el||this.$refs.side).getBoundingClientRect();this.sideAreaStickState=t.height+t.top-this.yOffset.top<=i.height?"bottom":"top"}else e<0&&(this.sideAreaStickState="none")},handleProgressBarState:function(t,e){var i=t.top<this.yOffset.top&&t.height+t.top>this.yOffset.top;this.shouldShowProgress!==i&&this.setProgressVisibility(i),this.scrollProgress>e&&(clearTimeout(this.runnable),this.runnable=setTimeout(function(){this.setProgressVisibility(!1)}.bind(this),500))},handleFabState:function(t){if(this.scrollProgress>=70){var e=t.height+t.top>=window.innerHeight-this.yOffset.bottom;this.setFabVisibility(e)}else this.setFabVisibility(!1)},sendComScoreEvent:function(t){this.fragmentComscoreStateList[t]||(this.fragmentComscoreStateList[t]=!0,this.$store.getters.preview||App.sendComScoreEvent(this.article.url))}}};Vue.component("article-wrapper",{props:["index","article"],mixins:[articleWrapperMixin],data:function(){return{yOffset:{top:0,bottom:0},replacementCover:null,shouldShowProgress:!1,shouldShowFab:!1,sideAreaStickState:"none",runnable:null,scrollProgress:0,currentFragmentIndex:-1,fragmentComscoreStateList:[],images:[]}},computed:{dfpMeta:function(){return this.$store.getters.dfp},isActive:function(){return this.index===this.$store.getters.activeIndex}},methods:{prepareGalleryImages:function(){var t=this;this.$refs.container.querySelectorAll(".wrapper-a img, .article-fragment .content-image-wrapper img:not(.article-gallery__image):not(.no-enlarge)").forEach(function(e){var i=e.getAttribute("src"),n=!1;for(var s in t.images)if(s.src===i){n=!0;break}n||t.images.push({src:i,title:e.title,w:0,h:0})}),$(this.$refs.container).on("click",".wrapper-a img",function(){t.openGallery($(this).attr("src"))}),$(this.$refs.container).on("click",".article-fragment .content-image-wrapper",function(){t.openGallery($(this).find("img").attr("src"))})},openGallery:function(t){for(var e=-1,i=0,n=this.images.length;i<n;i++)if(this.images[i].src===t){e=i;break}this.$store.commit("SET_GALLERY_DATA",{images:this.images,options:{index:e},article:this.article})},setReplacementCover:function(t){var e=new Image;e.onload=function(){e.width>=400&&e.height>=400&&(this.replacementCover=t,this.images.splice(0,1))}.bind(this),e.src=t},handleScroll:function(){var t=this.$refs.container.getBoundingClientRect();if(this.isActive){if(1===Number.parseInt(this.article.is_app_exclusive))return;this.handleContentScrollState();var e=this.$refs.content.$refs.contentBody;e&&e.map(this.handleFragmentScorllState),this.handleFabState(t)}else t.top<this.yOffset.top&&t.height+t.top>this.yOffset.top&&(this.$emit("on-article-active",this.index),0===Number.parseInt(this.article.is_app_exclusive)&&this.handleContentScrollState()),this.sideAreaStickState="none",this.currentFragmentIndex=-1},handleFragmentScorllState:function(t,e){var i=t.getBoundingClientRect();this.currentFragmentIndex!==e&&i.top<this.yOffset.top&&i.height+i.top>this.yOffset.top&&(this.currentFragmentIndex=e,this.$emit("on-fragment-active",this.index,this.currentFragmentIndex),this.sendComScoreEvent(this.currentFragmentIndex))},handleBanners:function(){"undefined"!=typeof googletag&&googletag.cmd.push(function(){for(var t=[],e=1;e<this.dfpMeta.length;e++)if(-1===this.dfpMeta[e].slot.indexOf("lightboxtop")){var i,n=JSON.parse(this.dfpMeta[e].sizeSet),s=[this.article.section.name_chi];this.article.subsection&&s.push(this.article.subsection.name_chi);var o=googletag.sizeMapping();if(this.dfpMeta[e].mapping)for(var r=1;r<this.dfpMeta[e].mapping;r++){var a=this.dfpMeta[e].mapping[r];o.addSize(a.key,a.val)}else o.addSize([0,0],n);if(i=-1!==this.dfpMeta[e].slot.indexOf("special")?googletag.defineOutOfPageSlot(this.dfpMeta[e].slot,this.dfpMeta[e].zone+"-"+e+"-"+this.article.id).defineSizeMapping(o.build()).addService(googletag.pubads()).setTargeting("article_id",this.article.id).setTargeting("section",s):googletag.defineSlot(this.dfpMeta[e].slot,n,this.dfpMeta[e].zone+"-"+e+"-"+this.article.id).defineSizeMapping(o.build()).addService(googletag.pubads()).setTargeting("article_id",this.article.id).setTargeting("section",s),this.article.formal_tags){var l=[];this.article.formal_tags.forEach(function(t){l=l.concat(t.name.split(/[,-]/))}),i.setTargeting("formal_tag",l)}this.article.content_targeting&&i.setTargeting("keyword",this.article.content_targeting.split(/,/)),t.push(i),googletag.display(this.dfpMeta[e].zone+"-"+e+"-"+this.article.id)}this.index>0&&(App.UBBannerSwap.swapBannerAfterward(".contents-container__article[data-id="+this.article.id+"] .ad-zone-swapper"),googletag.pubads().refresh(t))}.bind(this))},sendAppOnlyEvent:function(t){App.sendGAEvent("App Only Content Page",t,location.href)}},beforeMount:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll)},mounted:function(){if(1!==Number.parseInt(this.article.is_app_exclusive)){this.yOffset.top=$("#global-menu").height(),this.yOffset.bottom=$("#article-nav").height();var t=this.$refs.content.$refs.contentBody;t&&(t.map(function(){this.fragmentComscoreStateList.push(!1)}.bind(this)),0===this.index&&(this.fragmentComscoreStateList[0]=!0)),this.handleBanners(),this.prepareGalleryImages(),this.article.shouldScrollOnLoaded&&this.$emit("on-scroll-ready",this.index)}},template:"#v-article-wrapper"}),Vue.component("article-cover",{props:["article","replacement"],computed:{getImageSrc:function(){return this.replacement?{src:this.replacement}:this.article.cover?{"data-has-cover":!0,src:this.getResponsiveImage("large"),srcset:this.getResponsiveImage("thumbnail")+" 480w,"+this.getResponsiveImage("medium")+" 960w,"+this.getResponsiveImage("large")+" 1280w"}:{src:"assets/img/responsive/placeholder.jpg"}}},methods:{getResponsiveImage:function(t){return this.article.cover_base_dir+t+"/"+this.article.cover}},template:"#v-article-cover"});var recommendedArticleLinkMixin={methods:{handleRecommendedLinkClicked:function(t){"A"===t.target.tagName&&App.sendGAEvent("Detail Page Links","延伸閱讀")}}},RecommendedArticleLink=Vue.component("recommended-article-link",{props:["list","rawHtml"],template:"#v-recommended-article-link",mixins:[recommendedArticleLinkMixin]}),EnlargeWrapper=Vue.component("enlarge-wrapper",{props:["rawHtml"],template:"#v-enlarge-wrapper"});Vue.component("article-content-area",{props:["index","article"],methods:{processContentImages:function(t){var e=this.article.cover;t.forEach(function(t){t.querySelectorAll("img:not(.article-gallery__image):not(.no-enlarge)").forEach(function(t){"A"!==t.parentElement.tagName&&new EnlargeWrapper({propsData:{rawHtml:t.outerHTML},el:t}),e||(e=!0,this.$emit("on-replacement-cover-found",t.src))}.bind(this))}.bind(this))},parsePhotoGallery:function(t,e){t.querySelectorAll("ul").forEach(function(t){var i=[],n=t.querySelectorAll("li img");n.length>0&&(n.forEach(function(t){i.push({src:t.src,title:t.title,alt:t.alt,w:0,h:0})}),new ArticleGallery({el:t,store:store,data:{author:e,images:i}}))})},overrideAnchorHash:function(t){var e=window.location.href.split("#")[0];t.querySelectorAll('a[href^="#"]').forEach(function(t){t.setAttribute("href",e+t.getAttribute("href"))})},overrideRelatedArticleLink:function(t){t.querySelectorAll(".u-related-article__link").forEach(function(t){var e=t.innerHTML;new RecommendedArticleLink({propsData:{rawHtml:e},el:t})})},overrideContents:function(t){var e=this.article.author;t.forEach(function(t){this.parsePhotoGallery(t,e),this.overrideAnchorHash(t),this.overrideRelatedArticleLink(t)}.bind(this))},sendSocialEvent:function(t){ga("send","event",{eventCategory:"Detail Page Links",eventAction:t,eventLabel:window.location.href})}},mounted:function(){var t=this.$refs.contentBody;t&&(this.overrideContents(t),this.processContentImages(t),0!==this.index&&App.VideoEmbed.run($(t)))},template:"#v-article-content-area"});var ArticleGallery=Vue.component("article-gallery",{data:function(){return{article:null,images:[]}},computed:{totalImages:function(){return this.images.length},overlayClass:function(){return function(t){return{"d-lg-none d-xl-none":2===t}}},imageClass:function(){return function(t){return{"d-none d-lg-block":t>=3}}},background:function(){return function(t){return"backgroundImage: url("+t.src+")"}}},methods:{openGallery:function(t){this.$store.commit("SET_GALLERY_DATA",{images:this.images,options:{index:t},article:this.article})}},template:"#v-article-gallery"});Vue.component("article-side-area",{props:["article","stickState"],computed:{dfpMeta:function(){return this.$store.getters.dfp},rightColumnTitle:function(){return this.article.blogger?"最新博客文章":"最高瀏覽"},getClass:function(){switch(this.stickState){case"top":return"stay";case"bottom":return"remove";default:return""}},getStyle:function(){return"top"===this.stickState?"top: 75px":""}},template:"#v-article-side-area"}),Vue.component("related-product-list",{props:["list"],methods:{getCarouselConfig:function(t,e){var i={items:t,nav:!0,mouseDrag:!0,touchDrag:!0};return e&&(i.margin=e),i}},directives:{carousel:{inserted:function(t,e,i){var n=i.context.getCarouselConfig;$(t).owlCarousel({margin:15,nav:!0,dots:!1,smartSpeed:200,navText:['<i class="fa fa-angle-left fa-2x"></i>','<i class="fa fa-angle-right fa-2x"></i>'],responsive:{0:n(1,5),440:n(1,5),768:n(2),991:n(2,25),1200:n(2,25)}})}}},template:"#v-related-product-list"}),Vue.component("photo-swiper",{data:function(){return{el:null,gallery:null,slot:null,listen:!1}},computed:{galleryData:function(){return this.$store.state.galleryData},meta:function(){return this.$store.state.dfp[3]}},methods:{getImageSize:function(t,e){if(e.w<1||e.h<1){var i=new Image;i.onload=function(){e.w=i.width,e.h=i.height,this.gallery.updateSize(!0)}.bind(this),i.src=e.src}},initBanner:function(){googletag.cmd.push(function(){this.slot=googletag.defineSlot(this.meta.slot,JSON.parse(this.meta.sizeSet),this.meta.zone).addService(googletag.pubads()),googletag.display(this.meta.zone)}.bind(this))},open:function(){this.$refs.container.style.display="flex",this.listen||(this.listen=!0,window.addEventListener("scroll",this.handleScroll)),this.gallery.init()},close:function(){this.$refs.container.style.display="none",this.listen&&(this.listen=!1,window.removeEventListener("scroll",this.handleScroll))},handleScroll:function(){this.gallery&&this.gallery.close()}},watch:{galleryData:function(){if(this.galleryData.images.length>0){var t=this.galleryData.options;t.modal=!1,t.history=!1,this.gallery=new PhotoSwipe(this.el,PhotoSwipeUI_Default,this.galleryData.images,t),this.gallery.listen("gettingData",this.getImageSize),this.gallery.listen("close",function(){this.close()}.bind(this)),this.gallery.listen("afterChange",function(){"undefined"!=typeof googletag&&(this.slot||this.initBanner(),googletag.pubads().refresh([this.slot])),ga("set",getDimensions(this.galleryData.article)),ga("send","pageview","analytics?type=image&target="+encodeURIComponent(this.gallery.currItem.src))}.bind(this)),this.open()}}},beforeDestroy:function(){this.close()},directives:{photoSwipe:{inserted:function(t,e,i){i.context.el=t}}},template:"#v-photo-swiper"}),Vue.component("article-tag-list",{props:["list","formalTagList"],methods:{pickLastWord:function(t){if(!t)return"";var e=t.split("-");return e[e.length-1]}},template:"#v-article-tag-list"}),Vue.component("latest-article-list",{props:["title","list","isLatestPopular"],methods:{goTo:function(t,e){ga("send","event",{eventCategory:"Detail Page Links",eventAction:this.isLatestPopular?"Latest Popular Article":"Latest Article"+(t+1),hitCallback:function(){location.href=e},hitCallbackFail:function(){location.href=e}})}},template:"#v-latest-article-list"});var relatedArticleMixin={methods:{handleMayLikeLinkClicked:function(t){App.sendGAEvent("Detail Page Links","你也可能喜歡","文章"+t)}}};Vue.component("related-article-list",{props:["list"],template:"#v-related-article-list",mixins:[relatedArticleMixin],methods:{getSection:function(t){return t.split("/")[0]}}}),Vue.component("promotion-item",{props:["titleColor","title","secondTitle","imgSrc","link"],template:"#v-promotion-item"}),Vue.component("promotion-list",{template:"#v-promotion-list"});var openAppMixin={props:["base"],computed:{article:function(){return this.$store.getters.activeArticle},href:function(){return this.article.subsection?this.base+encodeURIComponent(this.article.subsection.uri+"/"+this.article.id):"#"}},methods:{sendGAEvent:function(t){App.sendGAEvent("Open in App",t)}}};Vue.component("progress-bar-btn-open-app",{mixins:[openAppMixin],template:"#v-progress-bar-btn-open-app"}),Vue.component("open-app-link",{mixins:[openAppMixin],data:function(){return{disabled:!1}},computed:{show:function(){return!this.disabled&&this.$store.state.openAppLinkVisible}},methods:{close:function(){this.$store.commit("SET_OPEN_APP_VISIBLE",!1),this.disabled=!0}},template:"#v-open-app-link"});